axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14)
)
# Crear el lineplot
A <- ggplot(df_avg_inflation, aes(x = year, y = inflation, color = region, group = region)) +
geom_line(size=1.5) +
scale_y_continuous(limits = c(0, 23)) +
geom_text(data = df_avg_inflation %>% filter(inflation > 23),
aes(label = round(inflation, 1), y = 23),
color = "green", size = 3, vjust = -0.5) +
geom_point(size=3) +
labs(title = "Evolución de la Inflación Promedio Anual por Región",
x = "Año",
y = "Inflación Promedio",
color = "Región")
knitr::include_graphics("Inflacion_Anual_Region.png")
# Al ejecutar el gráfico previamente se podia observar que el formato del CPI cambió en 2012, siendo 100 la puntuación máxima en lugar de 10.
df_melted %>%
filter(year %in% c(2010, 2011, 2012, 2013)) %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
head(4)
# Multiplico por 10 el CPI de los años 1995 hasta 2011 para que estén en la misma escala que los años posteriores
df_melted <- df_melted %>%
mutate(score = ifelse(year >= 1995 & year <= 2011, score * 10, score))
# Calcular el CPI promedio anual por región
df_avg_score <- df_melted %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Eliminar filas con valores nulos en la columna 'score', provocaban warnings
df_avg_score <- df_avg_score %>% drop_na(score)
# Crear el lineplot
A <- ggplot(df_avg_score, aes(x = year, y = score, color = region, group = region)) +
geom_line(size=1.5) +
geom_point(size=3) +
labs(title = "Evolución del Indice de Percepción de Corrupción Promedio Anual (CPI) por Región",
x = "Año",
y = "CPI Promedio",
color = "Región")
knitr::include_graphics("CPI_Region_Año.png")
# Calculo los valores medios de inflación y puntuación de corrupción por país
df_avg <- df_melted %>%
group_by(country, region) %>%
summarise(
inflation = median(inflation, na.rm = TRUE),
score = mean(score, na.rm = TRUE), .groups = "drop"
) %>%
arrange(region, country)
# Nota1: ordeno por región y país para que el hue siga el mismo orden que el resto
# Nota2: utilizo la mediana para la inflación para evitar que valores extremos como los de Bulgaria y Venezuela ya mencionados.
# Crear el scatter plot para visualizar la correlación entre inflación y puntuación de corrupción
# Crear el scatter plot con una línea de regresión única para todas las regiones pero sin el scatter (Quiero una única linea de regresión)
A <- ggplot(df_avg, aes(x = inflation, y = score, color = region)) +
geom_point(size = 3) +
geom_smooth(method = "lm", se = FALSE, linetype = "dashed", size = 2.5, color = "black", formula = y ~ x) +
labs(
title = "Correlación entre Inflación y Puntuación de Corrupción por País",
x = "Inflación Mediana",
y = "Puntuación de Corrupción Promedio",
color = "Región"
)
knitr::include_graphics("Correlacion_CPI_Inflacion.png")
# Calcular el coeficiente de correlación de Spearman
corr_test <- cor.test(df_melted$inflation, df_melted$score,
method = "spearman", use = "complete.obs",
exact = FALSE)
# Nota: Utilizo el método de Spearman porque no se una distribución normal y hay valores extremos
# Nota: Me saltaba el error de que no era posible calcular el coeficiente exacto, por lo que lo he puesto en FALSE, es decir, que no se calcula exactamente.
# Definir el nivel de significancia
alpha <- 0.05
# Mostrar los resultados
cat("Coeficiente de Correlación de Spearman's Rank:", corr_test$estimate, "\n")
if (corr_test$p.value < alpha) {
cat("p-valor:", corr_test$p.value, ", Se rechaza la hipótesis nula\n")
} else {
cat("p-valor:", corr_test$p.value, ", No se rechaza la hipótesis nula\n")
}
# Crear el lineplot
A <- ggplot(df_avg_inflation, aes(x = year, y = inflation, color = region, group = region)) +
geom_line(size=1.5) +
scale_y_continuous(limits = c(0, 23)) +
geom_text(data = df_avg_inflation %>% filter(inflation > 23),
aes(label = round(inflation, 1), y = 23),
color = "green", size = 3, vjust = -0.5) +
geom_point(size=3) +
labs(title = "Evolución de la Inflación Promedio Anual por Región",
x = "Año",
y = "Inflación Promedio",
color = "Región")
print(A)
# Hacer las letras más grandes y los títulos centrados
theme_update(
plot.title = element_text(size = 20, hjust = 0.5),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14)
)
# Crear el lineplot
ggplot(df_avg_inflation, aes(x = year, y = inflation, color = region, group = region)) +
geom_line(size=1.5) +
scale_y_continuous(limits = c(0, 23)) +
geom_text(data = df_avg_inflation %>% filter(inflation > 23),
aes(label = round(inflation, 1), y = 23),
color = "green", size = 3, vjust = -0.5) +
geom_point(size=3) +
labs(title = "Evolución de la Inflación Promedio Anual por Región",
x = "Año",
y = "Inflación Promedio",
color = "Región")
library(tidyr)
library(dplyr)
library(ggplot2)
df <- read.csv("inflation_corruption_1995_2023_Ruben_Valverde.csv")
head(df[0:6])
# Nota: El resto de columnas son repeticiones de las columnas 3, 4 y 5 por lo que mostrarlas no aportan más información y empeoran la estética
# Contar valores "no data" en cada columna
inflation <- df[, grepl("inflation", names(df))]
no_data_count <- colSums(inflation == "no data", na.rm = TRUE)
print(paste("Hay un total de", sum(no_data_count), "valores 'no data'"))
# Reemplazar los valores "no data" por NA en todo el DataFrame porque da problemas al conteo
df[df == "no data"] <- NA
# Convertir las columnas de inflación de 1995 a 2023 a valores numéricos
for (year in 1995:2023) {
column <- paste("inflation", year, sep = "_")
df[[column]] <- as.numeric(df[[column]])
}
# Contar y mostrar el número de valores nulos por columna
print(paste("Hay un total de", sum(is.na(df)), "valores nulos"))
# Transformar el DataFrame de formato ancho a formato largo para poder analizar los datos de inflación, puntuación y rango a lo largo del tiempo posteriormente
df_melted <- df %>%
pivot_longer(cols = starts_with("inflation_") | starts_with("score_") | starts_with("rank_"),
names_to = c(".value", "year"),
names_sep = "_") %>%
select(country, iso, region, year, inflation, score, rank)
# Convertir las columnas 'inflation', 'rank' y 'score' a tipo numérico en el DataFrame df_melted
df_melted <- df_melted %>%
mutate(across(c(inflation, rank, score), as.numeric))
head(df_melted)
summary(df_melted)
# Crear un DataFrame con la inflación promedio anual por región
df_avg_inflation <- df_melted %>%
group_by(region, year) %>%
summarise(inflation = median(inflation, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Nota: Se utilizó la mediana en lugar del promedio para evitar que valores extremos afecten el resultado (Como la inflación de 1995 en Europa Oriental y Asia Central causada por Bulgaria y Venezuela en América)
# Agregar un tema a los gráficos
theme_set(theme_bw())
# Ajustar el tamaño de los gráficos
options(repr.plot.width=17, repr.plot.height=7)
# Hacer las letras más grandes y los títulos centrados
theme_update(
plot.title = element_text(size = 20, hjust = 0.5),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14)
)
# Crear el lineplot
ggplot(df_avg_inflation, aes(x = year, y = inflation, color = region, group = region)) +
geom_line(size=1.5) +
scale_y_continuous(limits = c(0, 23)) +
geom_text(data = df_avg_inflation %>% filter(inflation > 23),
aes(label = round(inflation, 1), y = 23),
color = "green", size = 3, vjust = -0.5) +
geom_point(size=3) +
labs(title = "Evolución de la Inflación Promedio Anual por Región",
x = "Año",
y = "Inflación Promedio",
color = "Región")
knitr::include_graphics("Inflacion_Anual_Region.png")
# Al ejecutar el gráfico previamente se podia observar que el formato del CPI cambió en 2012, siendo 100 la puntuación máxima en lugar de 10.
df_melted %>%
filter(year %in% c(2010, 2011, 2012, 2013)) %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
head(4)
# Multiplico por 10 el CPI de los años 1995 hasta 2011 para que estén en la misma escala que los años posteriores
df_melted <- df_melted %>%
mutate(score = ifelse(year >= 1995 & year <= 2011, score * 10, score))
# Calcular el CPI promedio anual por región
df_avg_score <- df_melted %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Eliminar filas con valores nulos en la columna 'score', provocaban warnings
df_avg_score <- df_avg_score %>% drop_na(score)
# Crear el lineplot
A <- ggplot(df_avg_score, aes(x = year, y = score, color = region, group = region)) +
geom_line(size=1.5) +
geom_point(size=3) +
labs(title = "Evolución del Indice de Percepción de Corrupción Promedio Anual (CPI) por Región",
x = "Año",
y = "CPI Promedio",
color = "Región")
knitr::include_graphics("CPI_Region_Año.png")
# Calculo los valores medios de inflación y puntuación de corrupción por país
df_avg <- df_melted %>%
group_by(country, region) %>%
summarise(
inflation = median(inflation, na.rm = TRUE),
score = mean(score, na.rm = TRUE), .groups = "drop"
) %>%
arrange(region, country)
# Nota1: ordeno por región y país para que el hue siga el mismo orden que el resto
# Nota2: utilizo la mediana para la inflación para evitar que valores extremos como los de Bulgaria y Venezuela ya mencionados.
# Crear el scatter plot para visualizar la correlación entre inflación y puntuación de corrupción
# Crear el scatter plot con una línea de regresión única para todas las regiones pero sin el scatter (Quiero una única linea de regresión)
A <- ggplot(df_avg, aes(x = inflation, y = score, color = region)) +
geom_point(size = 3) +
geom_smooth(method = "lm", se = FALSE, linetype = "dashed", size = 2.5, color = "black", formula = y ~ x) +
labs(
title = "Correlación entre Inflación y Puntuación de Corrupción por País",
x = "Inflación Mediana",
y = "Puntuación de Corrupción Promedio",
color = "Región"
)
knitr::include_graphics("Correlacion_CPI_Inflacion.png")
# Calcular el coeficiente de correlación de Spearman
corr_test <- cor.test(df_melted$inflation, df_melted$score,
method = "spearman", use = "complete.obs",
exact = FALSE)
# Nota: Utilizo el método de Spearman porque no se una distribución normal y hay valores extremos
# Nota: Me saltaba el error de que no era posible calcular el coeficiente exacto, por lo que lo he puesto en FALSE, es decir, que no se calcula exactamente.
# Definir el nivel de significancia
alpha <- 0.05
# Mostrar los resultados
cat("Coeficiente de Correlación de Spearman's Rank:", corr_test$estimate, "\n")
if (corr_test$p.value < alpha) {
cat("p-valor:", corr_test$p.value, ", Se rechaza la hipótesis nula\n")
} else {
cat("p-valor:", corr_test$p.value, ", No se rechaza la hipótesis nula\n")
}
# Crear un DataFrame con la inflación promedio anual por región
df_avg_inflation <- df_melted %>%
group_by(region, year) %>%
summarise(inflation = median(inflation, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Nota: Se utilizó la mediana en lugar del promedio para evitar que valores extremos afecten el resultado (Como la inflación de 1995 en Europa Oriental y Asia Central causada por Bulgaria y Venezuela en América)
# Agregar un tema a los gráficos
theme_set(theme_bw())
# Ajustar el tamaño de los gráficos
options(repr.plot.width=17, repr.plot.height=7)
# Hacer las letras más grandes y los títulos centrados
theme_update(
plot.title = element_text(size = 20, hjust = 0.5),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14)
)
# Crear el lineplot
ggplot(df_avg_inflation, aes(x = year, y = inflation, color = region, group = region)) +
geom_line(size=1.5) +
scale_y_continuous(limits = c(0, 23)) +
geom_text(data = df_avg_inflation %>% filter(inflation > 23),
aes(label = round(inflation, 1), y = 23),
color = "green", size = 3, vjust = -0.5) +
geom_point(size=3) +
labs(title = "Evolución de la Inflación Promedio Anual por Región",
x = "Año",
y = "Inflación Promedio",
color = "Región")
library(tidyr)
library(dplyr)
library(ggplot2)
df <- read.csv("inflation_corruption_1995_2023_Ruben_Valverde.csv")
head(df[0:6])
# Nota: El resto de columnas son repeticiones de las columnas 3, 4 y 5 por lo que mostrarlas no aportan más información y empeoran la estética
# Contar valores "no data" en cada columna
inflation <- df[, grepl("inflation", names(df))]
no_data_count <- colSums(inflation == "no data", na.rm = TRUE)
print(paste("Hay un total de", sum(no_data_count), "valores 'no data'"))
# Reemplazar los valores "no data" por NA en todo el DataFrame porque da problemas al conteo
df[df == "no data"] <- NA
# Convertir las columnas de inflación de 1995 a 2023 a valores numéricos
for (year in 1995:2023) {
column <- paste("inflation", year, sep = "_")
df[[column]] <- as.numeric(df[[column]])
}
# Contar y mostrar el número de valores nulos por columna
print(paste("Hay un total de", sum(is.na(df)), "valores nulos"))
# Transformar el DataFrame de formato ancho a formato largo para poder analizar los datos de inflación, puntuación y rango a lo largo del tiempo posteriormente
df_melted <- df %>%
pivot_longer(cols = starts_with("inflation_") | starts_with("score_") | starts_with("rank_"),
names_to = c(".value", "year"),
names_sep = "_") %>%
select(country, iso, region, year, inflation, score, rank)
# Convertir las columnas 'inflation', 'rank' y 'score' a tipo numérico en el DataFrame df_melted
df_melted <- df_melted %>%
mutate(across(c(inflation, rank, score), as.numeric))
head(df_melted)
summary(df_melted)
# Crear un DataFrame con la inflación promedio anual por región
df_avg_inflation <- df_melted %>%
group_by(region, year) %>%
summarise(inflation = median(inflation, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Nota: Se utilizó la mediana en lugar del promedio para evitar que valores extremos afecten el resultado (Como la inflación de 1995 en Europa Oriental y Asia Central causada por Bulgaria y Venezuela en América)
# Agregar un tema a los gráficos
theme_set(theme_bw())
# Ajustar el tamaño de los gráficos
options(repr.plot.width=17, repr.plot.height=7)
# Hacer las letras más grandes y los títulos centrados
theme_update(
plot.title = element_text(size = 20, hjust = 0.5),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14)
)
# Crear el lineplot
A <- ggplot(df_avg_inflation, aes(x = year, y = inflation, color = region, group = region)) +
geom_line(size=1.5) +
scale_y_continuous(limits = c(0, 23)) +
geom_text(data = df_avg_inflation %>% filter(inflation > 23),
aes(label = round(inflation, 1), y = 23),
color = "green", size = 3, vjust = -0.5) +
geom_point(size=3) +
labs(title = "Evolución de la Inflación Promedio Anual por Región",
x = "Año",
y = "Inflación Promedio",
color = "Región")
knitr::include_graphics("Inflacion_Anual_Region.png")
# Al ejecutar el gráfico previamente se podia observar que el formato del CPI cambió en 2012, siendo 100 la puntuación máxima en lugar de 10.
df_melted %>%
filter(year %in% c(2010, 2011, 2012, 2013)) %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
head(4)
# Multiplico por 10 el CPI de los años 1995 hasta 2011 para que estén en la misma escala que los años posteriores
df_melted <- df_melted %>%
mutate(score = ifelse(year >= 1995 & year <= 2011, score * 10, score))
# Calcular el CPI promedio anual por región
df_avg_score <- df_melted %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Eliminar filas con valores nulos en la columna 'score', provocaban warnings
df_avg_score <- df_avg_score %>% drop_na(score)
# Crear el lineplot
A <- ggplot(df_avg_score, aes(x = year, y = score, color = region, group = region)) +
geom_line(size=1.5) +
geom_point(size=3) +
labs(title = "Evolución del Indice de Percepción de Corrupción Promedio Anual (CPI) por Región",
x = "Año",
y = "CPI Promedio",
color = "Región")
knitr::include_graphics("CPI_Region_Año.png")
# Calculo los valores medios de inflación y puntuación de corrupción por país
df_avg <- df_melted %>%
group_by(country, region) %>%
summarise(
inflation = median(inflation, na.rm = TRUE),
score = mean(score, na.rm = TRUE), .groups = "drop"
) %>%
arrange(region, country)
# Nota1: ordeno por región y país para que el hue siga el mismo orden que el resto
# Nota2: utilizo la mediana para la inflación para evitar que valores extremos como los de Bulgaria y Venezuela ya mencionados.
# Crear el scatter plot para visualizar la correlación entre inflación y puntuación de corrupción
# Crear el scatter plot con una línea de regresión única para todas las regiones pero sin el scatter (Quiero una única linea de regresión)
A <- ggplot(df_avg, aes(x = inflation, y = score, color = region)) +
geom_point(size = 3) +
geom_smooth(method = "lm", se = FALSE, linetype = "dashed", size = 2.5, color = "black", formula = y ~ x) +
labs(
title = "Correlación entre Inflación y Puntuación de Corrupción por País",
x = "Inflación Mediana",
y = "Puntuación de Corrupción Promedio",
color = "Región"
)
knitr::include_graphics("Correlacion_CPI_Inflacion.png")
# Calcular el coeficiente de correlación de Spearman
corr_test <- cor.test(df_melted$inflation, df_melted$score,
method = "spearman", use = "complete.obs",
exact = FALSE)
# Nota: Utilizo el método de Spearman porque no se una distribución normal y hay valores extremos
# Nota: Me saltaba el error de que no era posible calcular el coeficiente exacto, por lo que lo he puesto en FALSE, es decir, que no se calcula exactamente.
# Definir el nivel de significancia
alpha <- 0.05
# Mostrar los resultados
cat("Coeficiente de Correlación de Spearman's Rank:", corr_test$estimate, "\n")
if (corr_test$p.value < alpha) {
cat("p-valor:", corr_test$p.value, ", Se rechaza la hipótesis nula\n")
} else {
cat("p-valor:", corr_test$p.value, ", No se rechaza la hipótesis nula\n")
}
library(tidyr)
library(dplyr)
library(ggplot2)
df <- read.csv("inflation_corruption_1995_2023_Ruben_Valverde.csv")
head(df[0:6])
# Nota: El resto de columnas son repeticiones de las columnas 3, 4 y 5 por lo que mostrarlas no aportan más información y empeoran la estética
# Contar valores "no data" en cada columna
inflation <- df[, grepl("inflation", names(df))]
no_data_count <- colSums(inflation == "no data", na.rm = TRUE)
print(paste("Hay un total de", sum(no_data_count), "valores 'no data'"))
# Reemplazar los valores "no data" por NA en todo el DataFrame porque da problemas al conteo
df[df == "no data"] <- NA
# Convertir las columnas de inflación de 1995 a 2023 a valores numéricos
for (year in 1995:2023) {
column <- paste("inflation", year, sep = "_")
df[[column]] <- as.numeric(df[[column]])
}
# Contar y mostrar el número de valores nulos por columna
print(paste("Hay un total de", sum(is.na(df)), "valores nulos"))
# Transformar el DataFrame de formato ancho a formato largo para poder analizar los datos de inflación, puntuación y rango a lo largo del tiempo posteriormente
df_melted <- df %>%
pivot_longer(cols = starts_with("inflation_") | starts_with("score_") | starts_with("rank_"),
names_to = c(".value", "year"),
names_sep = "_") %>%
select(country, iso, region, year, inflation, score, rank)
# Convertir las columnas 'inflation', 'rank' y 'score' a tipo numérico en el DataFrame df_melted
df_melted <- df_melted %>%
mutate(across(c(inflation, rank, score), as.numeric))
head(df_melted)
summary(df_melted)
# Crear un DataFrame con la inflación promedio anual por región
df_avg_inflation <- df_melted %>%
group_by(region, year) %>%
summarise(inflation = median(inflation, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Nota: Se utilizó la mediana en lugar del promedio para evitar que valores extremos afecten el resultado (Como la inflación de 1995 en Europa Oriental y Asia Central causada por Bulgaria y Venezuela en América)
# Agregar un tema a los gráficos
theme_set(theme_bw())
# Ajustar el tamaño de los gráficos
options(repr.plot.width=17, repr.plot.height=7)
# Hacer las letras más grandes y los títulos centrados
theme_update(
plot.title = element_text(size = 20, hjust = 0.5),
axis.title = element_text(size = 16),
axis.text = element_text(size = 14),
legend.title = element_text(size = 16),
legend.text = element_text(size = 14)
)
# Crear el lineplot
A <- ggplot(df_avg_inflation, aes(x = year, y = inflation, color = region, group = region)) +
geom_line(size=1.5) +
scale_y_continuous(limits = c(0, 23)) +
geom_text(data = df_avg_inflation %>% filter(inflation > 23),
aes(label = round(inflation, 1), y = 23),
color = "green", size = 3, vjust = -0.5) +
geom_point(size=3) +
labs(title = "Evolución de la Inflación Promedio Anual por Región",
x = "Año",
y = "Inflación Promedio",
color = "Región")
knitr::include_graphics("Inflacion_Anual_Region.png")
# Al ejecutar el gráfico previamente se podia observar que el formato del CPI cambió en 2012, siendo 100 la puntuación máxima en lugar de 10.
df_melted %>%
filter(year %in% c(2010, 2011, 2012, 2013)) %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
head(4)
# Multiplico por 10 el CPI de los años 1995 hasta 2011 para que estén en la misma escala que los años posteriores
df_melted <- df_melted %>%
mutate(score = ifelse(year >= 1995 & year <= 2011, score * 10, score))
# Calcular el CPI promedio anual por región
df_avg_score <- df_melted %>%
group_by(region, year) %>%
summarise(score = mean(score, na.rm = TRUE), .groups = "drop") %>%
ungroup()
# Eliminar filas con valores nulos en la columna 'score', provocaban warnings
df_avg_score <- df_avg_score %>% drop_na(score)
# Crear el lineplot
A <- ggplot(df_avg_score, aes(x = year, y = score, color = region, group = region)) +
geom_line(size=1.5) +
geom_point(size=3) +
labs(title = "Evolución del Indice de Percepción de Corrupción Promedio Anual (CPI) por Región",
x = "Año",
y = "CPI Promedio",
color = "Región")
knitr::include_graphics("CPI_Region_Año.png")
# Calculo los valores medios de inflación y puntuación de corrupción por país
df_avg <- df_melted %>%
group_by(country, region) %>%
summarise(
inflation = median(inflation, na.rm = TRUE),
score = mean(score, na.rm = TRUE), .groups = "drop"
) %>%
arrange(region, country)
# Nota1: ordeno por región y país para que el hue siga el mismo orden que el resto
# Nota2: utilizo la mediana para la inflación para evitar que valores extremos como los de Bulgaria y Venezuela ya mencionados.
# Crear el scatter plot para visualizar la correlación entre inflación y puntuación de corrupción
# Crear el scatter plot con una línea de regresión única para todas las regiones pero sin el scatter (Quiero una única linea de regresión)
A <- ggplot(df_avg, aes(x = inflation, y = score, color = region)) +
geom_point(size = 3) +
geom_smooth(method = "lm", se = FALSE, linetype = "dashed", size = 2.5, color = "black", formula = y ~ x) +
labs(
title = "Correlación entre Inflación y Puntuación de Corrupción por País",
x = "Inflación Mediana",
y = "Puntuación de Corrupción Promedio",
color = "Región"
)
knitr::include_graphics("Correlacion_CPI_Inflacion.png")
# Calcular el coeficiente de correlación de Spearman
corr_test <- cor.test(df_melted$inflation, df_melted$score,
method = "spearman", use = "complete.obs",
exact = FALSE)
# Nota: Utilizo el método de Spearman porque no se una distribución normal y hay valores extremos
# Nota: Me saltaba el error de que no era posible calcular el coeficiente exacto, por lo que lo he puesto en FALSE, es decir, que no se calcula exactamente.
# Definir el nivel de significancia
alpha <- 0.05
# Mostrar los resultados
cat("Coeficiente de Correlación de Spearman's Rank:", corr_test$estimate, "\n")
if (corr_test$p.value < alpha) {
cat("p-valor:", corr_test$p.value, ", Se rechaza la hipótesis nula\n")
} else {
cat("p-valor:", corr_test$p.value, ", No se rechaza la hipótesis nula\n")
}
